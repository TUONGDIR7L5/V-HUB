<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - V-HUB</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    <style>
        body { background-color: #f8f9fa; font-family: 'Poppins', sans-serif; }
        .sidebar { width: 250px; background-color: #fff; height: 100vh; position: fixed; padding: 20px; }
        .sidebar .nav-link { color: #333; }
        .sidebar .nav-link:hover { background-color: #f0f0f0; border-radius: 5px; }
        .main-content { margin-left: 250px; padding: 30px; }
        .form-section { background-color: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
        .form-section h3 { margin-bottom: 20px; }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <h4 class="mb-4">Admin Dashboard</h4>
        <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link" href="#courses">Manage Courses</a></li>
            <li class="nav-item"><a class="nav-link" href="#lessons">Manage Lessons</a></li>
            <li class="nav-item"><a class="nav-link" href="#vocabulary">Manage Vocabulary</a></li>
            <li class="nav-item"><a class="nav-link" href="#blog-posts">Manage Blog Posts</a></li>
            <li class="nav-item"><a class="nav-link" href="#tests">Manage Tests</a></li>
            <li class="nav-item"><a class="nav-link" href="#stats">Manage Stats</a></li>
            <li class="nav-item"><a class="nav-link text-danger" href="/logout">Logout</a></li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Manage Courses -->
        <div id="courses" class="form-section">
            <h3>Add/Edit Course</h3>
            <form id="course-form" action="/admin/courses" method="POST">
                <div class="mb-3">
                    <label for="course-title" class="form-label">Title</label>
                    <input type="text" class="form-control" id="course-title" name="title" required>
                </div>
                <div class="mb-3">
                    <label for="course-level" class="form-label">Level</label>
                    <select class="form-select" id="course-level" name="level" required>
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advanced</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="course-description" class="form-label">Description</label>
                    <textarea class="form-control" id="course-description" name="description"></textarea>
                </div>
                <div class="mb-3">
                    <label for="course-content" class="form-label">Content</label>
                    <textarea class="form-control" id="course-content" name="content"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Save Course</button>
            </form>
        </div>

        <!-- Manage Blog Posts -->
        <div id="blog-posts" class="form-section mt-5">
            <h3>Add/Edit Blog Post</h3>
            <form id="blog-form" action="/admin/blog-posts" method="POST">
                <div class="mb-3">
                    <label for="blog-title" class="form-label">Title</label>
                    <input type="text" class="form-control" id="blog-title" name="title" required>
                </div>
                <div class="mb-3">
                    <label for="blog-content" class="form-label">Content</label>
                    <textarea class="form-control" id="blog-content" name="content"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Save Blog Post</button>
            </form>
        </div>
    </div>

    <script>
        // Khởi tạo TinyMCE cho các textarea
        tinymce.init({
            selector: 'textarea',
            plugins: 'advlist autolink lists link image charmap preview anchor searchreplace visualblocks code fullscreen insertdatetime media table paste code help wordcount',
            toolbar: 'undo redo | formatselect | bold italic | alignleft aligncenter alignright | bullist numlist outdent indent | link image | code preview',
            height: 400,
            menubar: false,
            content_style: 'body { font-family: Poppins, sans-serif; font-size: 14px }'
        });

        // Gửi form qua AJAX
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(form);
                const data = {};
                formData.forEach((value, key) => {
                    if (key === 'content' || key === 'description') {
                        value = tinymce.get(key).getContent();
                    }
                    data[key] = value;
                });
                const response = await fetch(form.action, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                alert(result.message);
            });
        });
    </script>
</body>
</html>